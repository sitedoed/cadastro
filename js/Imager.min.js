(function(e,h){var b=(function(){if(h.addEventListener){return function r(u,s,t){return u.addEventListener(s,t,false)}}else{return function q(u,s,t){return u.attachEvent("on"+s,t)}}})();var d=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,625,660,695,736];var n=typeof Object.keys==="function"?Object.keys:function(q){var s=[],r;for(r in q){s.push(r)}return s};var c=function(u,q){var s=0,t=u.length,r=[];for(;s<t;s++){r[s]=q(u[s],s)}return r};var i=function(q){return q};var o=function(){};var m=function(){return true};var k=function(q,s){var r;return function(){var v=this,u=arguments;var t=function(){r=null;q.apply(v,u)};clearTimeout(r);r=setTimeout(t,s)}};var p=function(s,r){var q=this;var t=h;r=r||{};if(s!==undefined){if(typeof s==="string"){r.selector=s;s=undefined}else{if(typeof s.length==="undefined"){r=s;s=undefined}}}this.viewportHeight=t.documentElement.clientHeight;this.selector=!s?(r.selector||".delayed-image-load"):null;this.className=r.className||"image-replace";this.gif=t.createElement("img");this.gif.src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7";this.gif.className=this.className;this.gif.alt="";this.gif.title="";this.lazyloadOffset=r.lazyloadOffset||0;this.scrollDelay=r.scrollDelay||250;this.onResize=r.hasOwnProperty("onResize")?r.onResize:true;this.lazyload=r.hasOwnProperty("lazyload")?r.lazyload:false;this.scrolled=false;this.availablePixelRatios=r.availablePixelRatios||[1,2];this.availableWidths=r.availableWidths||d;this.onImagesReplaced=r.onImagesReplaced||o;this.widthsMap={};this.refreshPixelRatio();this.widthInterpolator=r.widthInterpolator||i;this.gif.removeAttribute("height");this.gif.removeAttribute("width");if(typeof this.availableWidths!=="function"){if(typeof this.availableWidths.length==="number"){this.widthsMap=p.createWidthsMap(this.availableWidths,this.widthInterpolator,this.devicePixelRatio)}else{this.widthsMap=this.availableWidths;this.availableWidths=n(this.availableWidths)}this.availableWidths=this.availableWidths.sort(function(v,u){return v-u})}this.divs=[];this.add(s||this.selector);this.ready(r.onReady);setTimeout(function(){q.init()},0)};p.prototype.add=function(s){s=s||this.selector;var r=typeof s==="string"?h.querySelectorAll(s):s;if(r&&r.length){var q=c(r,i);this.changeDivsToEmptyImages(q);this.divs=this.divs.concat(q)}};p.prototype.scrollCheck=function(){var r=this;var q=0;var s=[];if(this.scrolled){c(this.divs,function(t){if(r.isPlaceholder(t)){++q;if(r.isThisElementOnScreen(t)){s.push(t)}}});if(q===0){e.clearInterval(r.interval)}this.changeDivsToEmptyImages(s);this.scrolled=false}};p.prototype.init=function(){var q=this;this.initialized=true;var r=m;if(this.lazyload){this.registerScrollEvent();this.scrolled=true;q.scrollCheck();r=function(s){return q.isPlaceholder(s)===false}}else{this.checkImagesNeedReplacing(this.divs)}if(this.onResize){this.registerResizeEvent(r)}this.onReady()};p.prototype.ready=function(q){this.onReady=q||o};p.prototype.createGif=function(r){if(r.className.match(new RegExp("(^| )"+this.className+"( |$)"))){return r}var t=r.getAttribute("data-class");var s=r.getAttribute("data-width");var q=this.gif.cloneNode(false);if(s){q.width=s;q.setAttribute("data-width",s)}q.className=(t?t+" ":"")+this.className;q.setAttribute("data-src",r.getAttribute("data-src"));q.setAttribute("alt",r.getAttribute("data-alt")||this.gif.alt);q.setAttribute("title",r.getAttribute("data-title")||this.gif.title);r.parentNode.replaceChild(q,r);return q};p.prototype.changeDivsToEmptyImages=function(r){var q=this;c(r,function(t,s){r[s]=q.createGif(t)});if(this.initialized){this.checkImagesNeedReplacing(r)}};p.prototype.isPlaceholder=function(q){return q.src===this.gif.src};p.prototype.isThisElementOnScreen=function(q){var r=0;var s=p.getPageOffset()+this.lazyloadOffset;if(q.offsetParent){do{r+=q.offsetTop}while(q=q.offsetParent)}return r<(this.viewportHeight+s)};p.prototype.checkImagesNeedReplacing=function(q,s){var r=this;s=s||m;if(!this.isResizing){this.isResizing=true;this.refreshPixelRatio();c(q,function(t){if(s(t)){r.replaceImagesBasedOnScreenDimensions(t)}});this.isResizing=false;this.onImagesReplaced(q)}};p.prototype.replaceImagesBasedOnScreenDimensions=function(s){var q,r;r=p.getNaturalWidth(s);q=typeof this.availableWidths==="function"?this.availableWidths(s):this.determineAppropriateResolution(s);s.width=q;if(!this.isPlaceholder(s)&&q<=r){return}s.src=this.changeImageSrcToUseNewImageDimensions(s.getAttribute("data-src"),q);s.removeAttribute("width");s.removeAttribute("height")};p.prototype.determineAppropriateResolution=function(q){return p.getClosestValue(q.getAttribute("data-width")||q.parentNode.clientWidth,this.availableWidths)};p.prototype.refreshPixelRatio=function g(){this.devicePixelRatio=p.getClosestValue(p.getPixelRatio(),this.availablePixelRatios)};p.prototype.changeImageSrcToUseNewImageDimensions=function(r,q){return r.replace(/{width}/g,p.transforms.width(q,this.widthsMap)).replace(/{pixel_ratio}/g,p.transforms.pixelRatio(this.devicePixelRatio))};p.getPixelRatio=function f(q){return(q||e)["devicePixelRatio"]||1};p.createWidthsMap=function a(r,t,u){var s={},q=r.length;while(q--){s[r[q]]=t(r[q],u)}return s};p.transforms={pixelRatio:function(q){return q===1?"":"-"+q+"x"},width:function(q,r){return r[q]||q}};p.getClosestValue=function j(s,t){var r=t.length,q=t[r-1];s=parseFloat(s);while(r--){if(s<=t[r]){q=t[r]}}return q};p.prototype.registerResizeEvent=function(r){var q=this;b(e,"resize",k(function(){q.checkImagesNeedReplacing(q.divs,r)},100))};p.prototype.registerScrollEvent=function(){var q=this;this.scrolled=false;this.interval=e.setInterval(function(){q.scrollCheck()},q.scrollDelay);b(e,"scroll",function(){q.scrolled=true});b(e,"resize",function(){q.viewportHeight=h.documentElement.clientHeight;q.scrolled=true})};p.getPageOffsetGenerator=function l(q){if(q){return function(){return e.pageYOffset}}else{return function(){return h.documentElement.scrollTop}}};p.getNaturalWidth=(function(){if("naturalWidth" in (new Image())){return function(q){return q.naturalWidth}}return function(r){var q=h.createElement("img");q.src=r.src;return q.width}})();p.getPageOffset=p.getPageOffsetGenerator(Object.prototype.hasOwnProperty.call(e,"pageYOffset"));p.applyEach=c;p.addEvent=b;p.debounce=k;if(typeof module==="object"&&typeof module.exports==="object"){module.exports=exports=p}else{if(typeof define==="function"&&define.amd){define(function(){return p})}else{if(typeof e==="object"){e.Imager=p}}}}(window,document));